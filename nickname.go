package mnemonic

import (
	"crypto/sha256"
	"fmt"
	"math/big"
)

// Scale up the ~75k possible outputs with this factor by appending a number.
const kNumberLimit = 1000

// Nickname uses one-directional cryptographic hashing function to derive a
// stable, memorable string from the data passed to it. It is safe to share the
// nickname even when the source data is to remain private. There are about 75
// millions possible outputs, but if collisions are dangerous the caller should
// check for them and retry with modified input.
func Nickname(b []byte) string {
	h := sha256.Sum256(b)
	i := big.NewInt(0).SetBytes(h[:])

	aniLen := big.NewInt(int64(len(animals)))
	adjLen := big.NewInt(int64(len(adjectives)))

	var aniIndex, adjIndex, num big.Int
	i.DivMod(i, adjLen, &adjIndex)
	i.DivMod(i, aniLen, &aniIndex)
	i.DivMod(i, big.NewInt(kNumberLimit), &num)

	return fmt.Sprintf("%s %s %d", adjectives[adjIndex.Int64()],
		animals[aniIndex.Int64()], num.Int64())
}

var adjectives []string = []string{
	"abundant",
	"adorable",
	"agreeable",
	"alive",
	"ancient",
	"angry",
	"beautiful",
	"better",
	"bewildered",
	"big",
	"bitter",
	"black",
	"blue",
	"boiling",
	"brave",
	"breeze",
	"brief",
	"broad",
	"broken",
	"bumpy",
	"calm",
	"careful",
	"chilly",
	"chubby",
	"clean",
	"clever",
	"clumsy",
	"cold",
	"colossal",
	"cooing",
	"cool",
	"creepy",
	"crooked",
	"cuddly",
	"curly",
	"curved",
	"damaged",
	"damp",
	"dead",
	"deafening",
	"deep",
	"defeated",
	"delicious",
	"delightful",
	"dirty",
	"drab",
	"dry",
	"dusty",
	"eager",
	"early",
	"easy",
	"elegant",
	"embarrassed",
	"empty",
	"faint",
	"faithful",
	"famous",
	"fancy",
	"fast",
	"fat",
	"few",
	"fierce",
	"filthy",
	"flaky",
	"flat",
	"fluffy",
	"freezing",
	"fresh",
	"full",
	"gentle",
	"gifted",
	"gigantic",
	"glamorous",
	"gray",
	"greasy",
	"great",
	"green",
	"grumpy",
	"handsome",
	"happy",
	"heavy",
	"helpful",
	"helpless",
	"high",
	"hissing",
	"hollow",
	"hot",
	"huge",
	"icy",
	"immense",
	"important",
	"inexpensive",
	"itchy",
	"jealous",
	"jolly",
	"juicy",
	"kind",
	"large",
	"late",
	"lazy",
	"light",
	"little",
	"lively",
	"long",
	"loose",
	"loud",
	"low",
	"magnificent",
	"mammoth",
	"many",
	"massive",
	"melodic",
	"melted",
	"miniature",
	"modern",
	"mushy",
	"mysterious",
	"narrow",
	"nervous",
	"nice",
	"noisy",
	"numerous",
	"nutritious",
	"obedient",
	"obnoxious",
	"odd",
	"old",
	"old-fashioned",
	"orange",
	"panicky",
	"petite",
	"plain",
	"powerful",
	"prickly",
	"proud",
	"puny",
	"purple",
	"purring",
	"quaint",
	"quick",
	"quiet",
	"rainy",
	"rapid",
	"raspy",
	"red",
	"relieved",
	"repulsive",
	"rich",
	"rotten",
	"round",
	"salty",
	"scary",
	"scrawny",
	"screeching",
	"shallow",
	"short",
	"shy",
	"silly",
	"skinny",
	"slow",
	"small",
	"sparkling",
	"sparse",
	"square",
	"steep",
	"sticky",
	"straight",
	"strong",
	"substantial",
	"sweet",
	"swift",
	"tall",
	"tart",
	"tasteless",
	"teeny",
	"teeny-tiny",
	"tender",
	"thankful",
	"thoughtless",
	"thundering",
	"tiny",
	"ugliest",
	"uneven",
	"uninterested",
	"unsightly",
	"uptight",
	"vast",
	"victorious",
	"voiceless",
	"warm",
	"weak",
	"wet",
	"whispering",
	"white",
	"wide",
	"wide-eyed",
	"witty",
	"wooden",
	"worried",
	"wrong",
	"yellow",
	"young",
	"yummy",
	"zealous",
}

var animals []string = []string{
	"abyssinian",
	"affenpinscher",
	"akbash",
	"akita",
	"albatross",
	"alligator",
	"angelfish",
	"angora",
	"ant",
	"anteater",
	"antelope",
	"argentino",
	"armadillo",
	"audemer",
	"avocet",
	"axolotl",
	"aye",
	"baboon",
	"badger",
	"balinese",
	"bandicoot",
	"barb",
	"barnacle",
	"barracuda",
	"bat",
	"beagle",
	"bear",
	"beaver",
	"bee",
	"bee-eater",
	"beetle",
	"bernard",
	"binturong",
	"bird",
	"birman",
	"bison",
	"bloodhound",
	"blue",
	"boar",
	"bobcat",
	"bombay",
	"bongo",
	"bonobo",
	"booby",
	"bordeaux",
	"bracke",
	"budgerigar",
	"buffalo",
	"bulldog",
	"bullfrog",
	"burmese",
	"butterfly",
	"buzzard",
	"caiman",
	"camel",
	"capuchin",
	"capybara",
	"caracal",
	"cassowary",
	"cat",
	"caterpillar",
	"catfish",
	"cattle",
	"centipede",
	"chameleon",
	"chamois",
	"cheetah",
	"chicken",
	"chihuahua",
	"chimpanzee",
	"chin",
	"chinchilla",
	"chinook",
	"chipmunk",
	"chow",
	"cichlid",
	"civet",
	"clam",
	"coati",
	"cockroach",
	"collie",
	"coon",
	"coonhound",
	"coral",
	"corgi",
	"cougar",
	"cow",
	"coyote",
	"crab",
	"crane",
	"crocodile",
	"cuscus",
	"cuttlefish",
	"dachsbracke",
	"dachshund",
	"dalmatian",
	"dane",
	"deer",
	"devil",
	"dhole",
	"dingo",
	"discus",
	"dodo",
	"dog",
	"dogfish",
	"dollar",
	"dolphin",
	"donkey",
	"dormouse",
	"dragon",
	"dragonfly",
	"drever",
	"duck",
	"dugong",
	"dunker",
	"eagle",
	"earwig",
	"echidna",
	"eel",
	"elephant",
	"eleuth",
	"emperor",
	"emu",
	"falcon",
	"ferret",
	"fish",
	"flamingo",
	"flounder",
	"fly",
	"forest",
	"fossa",
	"fousek",
	"fowl",
	"fox",
	"foxhound",
	"frigatebird",
	"frise",
	"frog",
	"gar",
	"gecko",
	"gerbil",
	"gharial",
	"gibbon",
	"giraffe",
	"goat",
	"goose",
	"gopher",
	"gorilla",
	"grasshopper",
	"greyhound",
	"grouse",
	"guppy",
	"hamster",
	"hare",
	"harrier",
	"havanese",
	"hedgehog",
	"heron",
	"himalayan",
	"hippopotamus",
	"hornet",
	"horse",
	"hound",
	"human",
	"hummingbird",
	"husky",
	"hyena",
	"hyrax",
	"ibis",
	"iguana",
	"impala",
	"indri",
	"insect",
	"jackal",
	"jaguar",
	"javanese",
	"jellyfish",
	"kakapo",
	"kangaroo",
	"kingfisher",
	"kiwi",
	"koala",
	"kudu",
	"labradoodle",
	"ladybird",
	"lemming",
	"lemur",
	"leopard",
	"liger",
	"lion",
	"lionfish",
	"lizard",
	"llama",
	"lobster",
	"loon",
	"lynx",
	"macaque",
	"macaw",
	"magpie",
	"malamute",
	"maltese",
	"mammoth",
	"manatee",
	"mandrill",
	"markhor",
	"marmoset",
	"mastiff",
	"mau",
	"mayfly",
	"meerkat",
	"millipede",
	"mist",
	"mole",
	"molly",
	"mongoose",
	"mongrel",
	"monkey",
	"monster",
	"moorhen",
	"moose",
	"moth",
	"mouse",
	"mule",
	"neanderthal",
	"newfoundland",
	"newt",
	"nightingale",
	"numbat",
	"ocelot",
	"octopus",
	"okapi",
	"olm",
	"opossum",
	"orang-utan",
	"oriole",
	"ostrich",
	"otter",
	"owl",
	"oyster",
	"pademelon",
	"panda",
	"panther",
	"paradise",
	"parrot",
	"peacock",
	"peccary",
	"pekingese",
	"pelican",
	"penguin",
	"persian",
	"pheasant",
	"pig",
	"pika",
	"pike",
	"pinscher",
	"piranha",
	"platypus",
	"pointer",
	"poodle",
	"porcupine",
	"possum",
	"prawn",
	"puffin",
	"pug",
	"puma",
	"quail",
	"quetzal",
	"quokka",
	"quoll",
	"rabbit",
	"raccoon",
	"ragdoll",
	"rat",
	"rattlesnake",
	"ray",
	"reindeer",
	"retriever",
	"rhinoceros",
	"robin",
	"rottweiler",
	"russel",
	"salamander",
	"saola",
	"schnauzer",
	"scorpion",
	"seahorse",
	"seal",
	"serval",
	"setter",
	"shark",
	"sheep",
	"sheepdog",
	"shepherd",
	"shrew",
	"shrimp",
	"siamese",
	"siberian",
	"skater",
	"skunk",
	"sloth",
	"slug",
	"snail",
	"snake",
	"snowshoe",
	"somali",
	"spaniel",
	"sparrow",
	"spider",
	"spitz",
	"sponge",
	"spoonbill",
	"squid",
	"squirrel",
	"squirt",
	"starfish",
	"stingray",
	"stoat",
	"swan",
	"tamarin",
	"tang",
	"tapir",
	"tarantula",
	"tarsier",
	"termite",
	"terrier",
	"tetra",
	"tiffany",
	"tiger",
	"toad",
	"tortoise",
	"toucan",
	"tropicbird",
	"tuatara",
	"turkey",
	"turtle",
	"tzu",
	"uakari",
	"uguisu",
	"umbrellabird",
	"urchin",
	"vole",
	"vulture",
	"wallaby",
	"walrus",
	"warthog",
	"wasp",
	"weasel",
	"whale",
	"whippet",
	"wildebeest",
	"wolf",
	"wolfhound",
	"wolverine",
	"wombat",
	"woodlouse",
	"woodpecker",
	"worm",
	"wrasse",
	"yak",
	"zebra",
	"zebu",
	"zonkey",
	"zorse",
}
